

const mockMovies = [
  {
    "id": 17364,
    "title": "Their Eyes Were Watching God",
    "genres": [
      18,
      100,
      6251,
      10749,
      36,
      88
    ],
    "overview": "A drama set in the 1920s, where free-spirited Janie Crawford's search for happiness leads her through several different marriages, challenging the morals of her small town. Based on the novel by Zora Neale Hurston.",
    "triggers": "Abuse, Sexual Abuse",
    "video_key": "mc5T4c_mj1U",
    "poster_path": "/vVn2KohzehZMN40YmNM69HqXxWm.jpg",
    "backdrop_path": "/rUjagGCyE7Ggad4dKEvTc95e0Qe.jpg",
    "release_date": "2005-03-06",
    "watch_data": "https://www.youtube.com/watch?v=teUi8N5ZaNs",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 113
  },
  {
    "id": 51044,
    "title": "Carmen Jones",
    "genres": [
      18,
      10402,
      10749,
      89
    ],
    "overview": "The tale of the cigarette-maker Carmen and the Spanish cavalry soldier Don Jose is translated into a modern-day story of a parachute factory worker and a stalwart GI named Joe who is about to go to flying school. Conflict arises when a prize-ring champ captures the heart of Carmen after she has seduced Joe and caused him to go AWOL.",
    "video_key": "OPe2HLwqgc8",
    "poster_path": "/5Vo4NeE7dlXBUaikbGnUOmUNHJ3.jpg",
    "backdrop_path": "/xoUIM9TXXL062YKN1o6a56MJY0X.jpg",
    "release_date": "1954-10-28",
    "watch_data": "https://www.themoviedb.org/movie/51044-carmen-jones/watch?locale=US",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 105
  },
  {
    "id": 9400,
    "title": "Set It Off",
    "genres": [
      18,
      100,
      80,
      53
    ],
    "overview": "Four black women, all of whom have suffered for lack of money and at the hands of the majority, undertake to rob banks. While initially successful, a policeman who was involved in shooting one of the women's brothers is on their trail. As the women add to the loot, their tastes and interests begin to change and their suspicions of each other increase on the way to a climactic robbery.",
    "video_key": "bKB2KclDMTY",
    "poster_path": "/gXMfASh25sLvES9D7riFGBNNJrm.jpg",
    "backdrop_path": "/wFDpKNEAtUo6cuEcuecoKttD0w1.jpg",
    "release_date": "1996-11-06",
    "watch_data": "https://www.themoviedb.org/movie/9400-set-it-off/watch?locale=US",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 123
  },
  {
    "id": 21539,
    "title": "The Preacher's Wife",
    "genres": [
      18,
      10749,
      14,
      103,
      10751
    ],
    "overview": "Good natured Reverend Henry Biggs finds that his marriage to choir mistress Julia is flagging, due to his constant absence caring for the deprived neighborhood they live in. On top of all this, his church is coming under threat from property developer Joe Hamilton. In desperation, Rev. Biggs prays to God for help - and help arrives in the form of an angel named Dudley.",
    "video_key": "kYIFhk4lutY",
    "poster_path": "/z1mU4g9poAgoDQRNLcfNdj3iiMs.jpg",
    "backdrop_path": "/hagiqBRxjzkJhq7ByddAISfzwuR.jpg",
    "release_date": "1996-12-13",
    "watch_data": "https://www.themoviedb.org/movie/21539-the-preacher-s-wife/watch?locale=US",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 124
  },
  {
    "id": 18423,
    "title": "B.A.P.S.",
    "genres": [
      100,
      35
    ],
    "overview": "Two clueless homegirls move to L.A. to become dancers, but instead find themselves scamming a dying millionaire to eventually become B*A*P*S (Black American Princesses).",
    "video_key": "cHPpnwYVV8s",
    "poster_path": "/yi40NrDfdv8vX0aoWvis3CnCVWj.jpg",
    "backdrop_path": "/HDPq5KVV9Yw2H0fhvMug3Oi9Xv.jpg",
    "release_date": "1997-03-28",
    "watch_data": "https://www.themoviedb.org/movie/18423-b-a-p-s/watch?locale=US",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 90
  },
  {
    "id": 46702,
    "title": "Why Do Fools Fall In Love",
    "genres": [
      18,
      10749,
      91
    ],
    "overview": "In the mid-80s, three women (each with an attorney) arrive at the office of New York entertainment manager, Morris Levy. One is an L.A. singer, formerly of the Platters; one is a petty thief from Philly; one teaches school in a small Georgia town. Each claims to be the widow of long-dead doo-wop singer-songwriter Frankie Lyman, and each wants years of royalties due to his estate, money Levy has never shared. During an ensuing civil trial, flashbacks tell the story of each one's life with Lyman, a boyish, high-pitched, dynamic performer, lost to heroin. Slowly, the three wives establish their own bond.",
    "video_key": "lIlWN0Dxvfw",
    "poster_path": "/44a2SIKFpTvjH6XK8UgADAAUs3a.jpg",
    "backdrop_path": "/e8kClV1nNDESWnO5ovRaZsHHO8b.jpg",
    "release_date": "1998-08-28",
    "watch_data": "https://www.themoviedb.org/movie/46702-why-do-fools-fall-in-love/watch?locale=US",
    "chosen_by": null,
    "date_watched": null,
    "seen": false,
    "runtime": 116
  },
  {
    "id": 44479,
    "title": "The Watermelon Woman",
    "genres": [
      100,
      35,
      69,
      6251,
      10749,
      18
    ],
    "overview": "Cheryl, a young black lesbian, works a day job in a video store while trying to make a film about a black actress from the 1930s known for playing the stereotypical \"mammy\" roles relegated to black actresses during that period. This was the first feature film directed by an \"out\" black lesbian.",
    "video_key": "OiTBGPmL2mo",
    "poster_path": "/i99v9sEza4OtThE2dc1Go7d4C7q.jpg",
    "backdrop_path": "/owqK3o510MyWXd0xUmjwAqyNbOd.jpg",
    "release_date": "1996-09-07",
    "watch_data": "https://www.themoviedb.org/movie/44479-the-watermelon-woman/watch?locale=US",
    "chosen_by": "Garrett",
    "date_watched": "06/13/20",
    "seen": true,
    "runtime": 85
  },
  {
    "id": 29478,
    "title": "A Raisin in the Sun",
    "genres": [
      18,
      89,
      87,
    ],
    "overview": "This lauded drama follows the Youngers, an African-American family living together in an apartment in Chicago. Following the death of their patriarch, they try to determine what to do with the substantial insurance payment they'll soon receive. Opinions on what to do with the money vary. Walter Lee wants to make a business investment, while his mother, Lena, is intent on buying a house for them all to live in -- two differing views of the American Dream.",
    "video_key": "0JUUWLLN03s",
    "poster_path": "/jerZFKkcF1rpCAGfzmf7FhOKynG.jpg",
    "backdrop_path": "/wiCuQXP8vJBfQuXl7kTSgfFcs8F.jpg",
    "release_date": "1961-05-28",
    "watch_data": "https://www.themoviedb.org/movie/29478-a-raisin-in-the-sun/watch?locale=US",
    "chosen_by": "Corey",
    "date_watched": "06/20/20",
    "seen": true,
    "runtime": 128
  },
  {
    "id": 448444,
    "title": "The Death and Life of Marsha P. Johnson",
    "genres": [
      99,
      69
    ],
    "overview": "Describing herself as a 'street queen,' Johnson was a legendary fixture in New York City’s gay ghetto and a tireless voice for LGBT pride since the days of Stonewall, who along with fellow trans icon Sylvia Rivera, founded Street Transvestites Action Revolutionaries (S.T.A.R.), a trans activist group based in the heart of NYC’s Greenwich Village. Her death in 1992 was declared a suicide by the NYPD, but friends never accepted that version of events. Structured as a whodunit, with activist Victoria Cruz cast as detective and audience surrogate, The Death and Life of Marsha P. Johnson celebrates the lasting political legacy of Johnson, while seeking to finally solve the mystery of her unexplained death.",
    "video_key": "pADsuuPd79E",
    "poster_path": "/4vsWzNOQfzMC0hdkZ58tIFEHXlw.jpg",
    "backdrop_path": "/fA16bfUd00jNbcdqheUTVnqcFBL.jpg",
    "release_date": "2017-07-27",
    "watch_data": "https://www.themoviedb.org/movie/448444-the-death-and-life-of-marsha-p-johnson/watch?locale=US",
    "chosen_by": "Scott",
    "date_watched": "06/27/20",
    "seen": true,
    "runtime": 105
  },
  {
    "id": 322903,
    "title": "Naz & Maalik",
    "genres": [
      18,
      69,
      10749
    ],
    "overview": "Two closeted Muslim teens hawk goods across Brooklyn and struggle to come clean about their sexuality, as their secretive behavior leads them unknowingly into the cross-hairs of the War on Terror.",
    "video_key": "pCuUqTeZIoY",
    "poster_path": "/jQuxNWZyPsY2LZFnIuAKEq4qKZk.jpg",
    "backdrop_path": "/xiuV0YG7guyzMW2wAY92U0dW9C9.jpg",
    "release_date": "2014-01-01",
    "watch_data": "https://www.themoviedb.org/movie/322903-naz-maalik/watch?locale=US",
    "chosen_by": "Nicki",
    "date_watched": "07/05/20",
    "seen": true,
    "runtime": 86
  },
  {
    "id": 318044,
    "title": "What Happened, Miss Simone?",
    "genres": [
      99,
      6251,
      10402
    ],
    "overview": "The film chronicles Nina Simone's journey from child piano prodigy to iconic musician and passionate activist, told in her own words.",
    "video_key": "MtnmncV74uM",
    "poster_path": "/zfU6mfxPns34TRwxKhp5pyBIgJt.jpg",
    "backdrop_path": "/xfMbreyyytL6vo0qsjIhUwEcMAO.jpg",
    "release_date": "2015-01-22",
    "watch_data": "https://www.themoviedb.org/movie/318044-what-happened-miss-simone/watch?locale=US",
    "chosen_by": "Christopher",
    "date_watched": "07/11/20",
    "runtime": 101,
    "seen": true
  },
  {
    "id": 424781,
    "title": "Sorry to Bother You",
    "genres": [
      100,
      102,
      887,
      878,
      18,
      14
    ],
    "overview": "In an alternate present-day version of Oakland, black telemarketer Cassius Green discovers a magical key to professional success – which propels him into a macabre universe.",
    "video_key": "XeISaoQDh2g",
    "poster_path": "/d1RjgVBaCk4frObcHqT8jnFBPU9.jpg",
    "backdrop_path": "/lHecBdFRnW2hh8Qn3wz0vrPIqw2.jpg",
    "release_date": "2018-10-29",
    "watch_data": "https://www.themoviedb.org/movie/424781-sorry-to-bother-you/watch?locale=US",
    "chosen_by": "Gillian",
    "date_watched": "07/18/20",
    "seen": true,
    "runtime": 112
  }
]

const insertMovie = (knex, movie) => {
  return knex('movie').insert({
    id: movie.id,
    title: movie.title,
    overview: movie.overview,
    video_key: movie.video_key,
    poster_path: movie.poster_path,
    backdrop_path: movie.backdrop_path,
    release_date: movie.release_date,
    runtime: movie.runtime,
    watch_data: movie.watch_data,
    triggers: movie['triggers'] ? movie.triggers : null ,
    seen: movie.seen,
    chosen_by: movie.chosen_by,
    date_watched: movie.date_watched
  }, 'id')
    .then(movie_id => {
      console.log("Attempting to seed movie with id:", movie_id)
      let genrePromises=[];
      movie.genres.forEach(genre => {
        genrePromises.push(insertGenres(knex, genre, movie_id));
      });
      return Promise.all(genrePromises);
    })
    .catch(err => {console.error("Error creating movies!", err)})
}

const insertGenres = (knex, genre, movie_id) => {
  return knex('genre').insert({
    genre_id: genre,
    movie_id: movie_id[0]
  });
}


exports.seed = function (knex) {
  // Deletes ALL existing entries
  return knex('genre').del()
    .then(() => knex('movie').del())
    .then(() => {
      let moviePromises = [];
      mockMovies.forEach(movie => moviePromises.push(insertMovie(knex, movie)));
      console.log("total movies: ", moviePromises.length)
      return Promise.all(moviePromises)
    })
    .catch(err => { console.error('Error seeding movies: ', err) })
};
